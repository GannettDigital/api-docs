### **Contact Interactions/Leads**
<a name="contact_interactions"></a>

**Summary:** This HIPAA Compliant endpoint supports integration with CRM products. It returns all interactions (or leads) generated by a campaign for an advertiser. The response is organized by campaigns with the interactions nested within. Please note that the response also includes the associated contact and its meta data.

**Parameters:** It requires the following parameters for a successful response: GMAID (advertiser ID), created_before date and created_after_date. An optional `event_type` parameter can be specified, to limit results to one of `chat`, `call`, or `form`.

**Recommended usage pattern:** A one-time call to the API to fetch all past interactions recorded by the LocaliQ platform, followed by daily recurrent calls for a 2 -3-day period to fetch new interactions. The results are paginated. If there is no data for a particular attribute, it will not be present in the results.

Please note that the contact information in this endpoint is for linking the interactions/leads with the contact. Importing them as contacts into your CRM from this endpoint will cause duplicates.

**Please note:** If you have the Live Chat Platinum product, the API response can contain non-lead chat information. A non-lead chat is in which the visitor does not provide their contact details (i.e. their name + email or phone). The contact information in the response is mock data. If you would like to remove non-lead chats from your integration, please filter out interactions containing the email "nonleadchat@reachlocal.com".


### Resource Overview&nbsp;

| Method | URI Format |
|---|---|
| GET | /crm/contact_interactions?[params]|
| GET | /crm/contact_interactions/:id|

### Parameters&nbsp;

Parameter | Required | Description
--------- | -------- | -----------
global\_master\_advertiser\_id | yes | The global master advertiser id (for example, TEST_1).
created\_after\_date | yes | Specifies the lower bound for the earliest date and time when searching for contact interactions.  All records returned in the response will have been created on or after this date.  The format expected is YYYY-MM-DD.
created\_before\_date | yes | Specifies the upper bound for the latest date and time when searching for contact interactions.  All records returned in the response will have been created before this date.  The format expected is YYYY-MM-DD.
page | no | The page number of the paginated result set to return.  This parameter is optional, but if the page requested doesn’t exist in the result set defined by the other parameters an empty JSON array is returned.<br>**Default value: 1** |
event_type | no | Must be one of `chat`, `call`, or `form`.  Limits results to records of that type.


### Response Data Details&nbsp;

```ruby
require 'uri'
require 'net/http'

url = URI("https://api.localiqservices.com/crm/contact_interactions?global_master_advertiser_id=TEST_1&created_after_date=2019-01-01&created_before_date=2019-01-10")

http = Net::HTTP.new(url.host, url.port)

request = Net::HTTP::Get.new(url)
request["Authorization"] = 'OAUTH_ACCESS_TOKEN'

response = http.request(request)
puts response.read_body
```

```java
OkHttpClient client = new OkHttpClient();

Request request = new Request.Builder()
  .url("https://api.localiqservices.com/crm/contact_interactions?global_master_advertiser_id=TEST_1&created_after_date=2019-01-01&created_before_date=2019-01-10")
  .get()
  .addHeader("Authorization", "OAUTH_ACCESS_TOKEN")
  .build();

Response response = client.newCall(request).execute();
```

```shell
curl --request GET \
  --url 'https://api.localiqservices.com/crm/contact_interactions?global_master_advertiser_id=TEST_1&created_after_date=2019-01-01&created_before_date=2019-01-10' \
  --header 'Authorization: OAUTH_ACCESS_TOKEN'
```

> Example Response

```json
{
    "global_master_advertiser_id": "TEST_1",
    "page": 1,
    "total_pages": 5,
    "next_page_location": "https://api.localiqservices.com/crm/contact_interactions?created_after_date=2019-01-01&created_before_date=2023-02-10&global_master_advertiser_id=TEST_1&page=2",
    "contact_interactions": [
        {
            "campaign_id": 400904,
            "campaign_name": "Organic Search",
            "id": 755428239,
            "created_at": "2023-01-04T15:31:11-08:00",
            "occured_at": "2023-01-04T15:28:46-08:00",
            "read_at": "2023-01-05T10:59:42-08:00",
            "tags": [
                "Call Lead",
                "Organic Search"
            ],
            "event_type": "call",
            "contact_id": 432323455,
            "status": "pending_contact",
            "display_name": "Flintstone, Fred",
            "contact": {
                "status": "pending_contact",
                "id": 432323455,
                "created_at": "2023-01-04T15:31:11-08:00",
                "tags": [
                    "Organic Search"
                ],
                "first_name": "Fred",
                "last_name": "Flintstone",
                "company": "",
                "phone_work": "+12627071229",
                "address1": "1234 Elm Street",
                "city": "Peoria",
                "state": "IL",
                "postal": "53095"
            },
            "call": {
                "occured_at": "2023-01-04T15:28:46-08:00",
                "target_number": "1231231234",
                "recording_url": "https://webservice.telmetrics.com/filedownload.ashx/bb01bae3-f6d4-4e1b-b295-481e92a7dd5e/2697305168.mp3",
                "duration": "00:55"
            }
        },
        {
            "campaign_id": 26330,
            "campaign_name": "Direct Site Traffic",
            "id": 1013951,
            "created_at": "2019-01-07T13:26:09-08:00",
            "occured_at": "2019-01-07T13:26:05-08:00",
            "tags": [
                "Direct Site Traffic",
                "Facebook"
            ],
            "event_type": "form",
            "contact_id": 9941,
            "status": "pending_contact",
            "display_name": "asdf",
            "contact": {
                "status": "pending_contact",
                "id": 9941,
                "created_at": "2017-11-16T11:11:04-08:00",
                "tags": [
                    "Direct Site Traffic"
                ],
                "first_name": "asdf",
                "last_name": "",
                "email": "asdf@asdf.com",
                "phone_work": "asdf",
                "company": "Slate Quarry",
                "address1": "123 Rubble Street",
                "address2": "Suite 1",
                "city": "Bedrock",
                "state": "AZ",
                "postal": "86046",
                "country": "USA"
            },
            "form": {
                "sub_type": "FormEmail",
                "subject": "Hi",
                "full_message": "Message:\nasdf",
                "message": "asdf",
                "extra_fields": {}
            },
            "archived_at": "2019-01-08T13:26:05-08:00"
        },
        {
            "campaign_id": 48127271,
            "master_campaign_id": "390971619",
            "campaign_name": "GCI | SA Smart | Squirrel Feed",
            "id": 185074076,
            "created_at": "2022-12-25T12:37:57-05:00",
            "occured_at": "2022-12-25T12:37:55-05:00",
            "tags": [
                "Facebook Lead",
                "Form Lead",
                "GCI | SA Smart | Squirrel Feed"
            ],
            "event_type": "form",
            "contact_id": 91774815,
            "status": "pending_contact",
            "display_name": "Pez, Dispenser",
            "contact": {
                "status": "pending_contact",
                "id": 91774815,
                "created_at": "2022-12-25T12:37:57-05:00",
                "tags": [
                    "GCI | SA Smart | Squirrel Feed"
                ],
                "first_name": "Dispenser",
                "last_name": "Pez",
                "phone_work": "5555555095",
                "postal": "90732",
                "email": "pez@gmail.com"
            },
            "form": {
                "sub_type": "FormPost",
                "full_message": "",
                "extra_fields": {
                    "fullName": "Dispenser Pez",
                    "zip_code": "90732",
                    "full_name": "Dispenser Pez",
                    "phone_number": "5555555095",
                    "are_you_the_homeowner?": "Yes",
                    "email": "pez@gmail.com"
                }
            }
        },
        {
            "campaign_id": 28002633,
            "campaign_name": "Organic Search",
            "id": 1876526262,
            "created_at": "2023-01-30T07:51:07-08:00",
            "occured_at": "2023-01-30T07:51:05-08:00",
            "tags": [
                "Chat Lead",
                "Organic Search",
                "Sales Chat"
            ],
            "event_type": "chat",
            "contact_id": 9293472379,
            "status": "pending_contact",
            "display_name": "Geddy Lee",
            "contact": {
                "status": "pending_contact",
                "id": 9293472379,
                "created_at": "2023-01-30T07:51:07-08:00",
                "tags": [
                    "Organic Search"
                ],
                "first_name": "Geddy",
                "last_name": "Lee",
                "email": "bass_player@yahoo.com",
                "phone_work": "262-555-0147",
                "company": "Border Foods"
            },
            "chat": {
                "summary": "Hello, I’m a Virtual Assistant ready to help. How can I help you?\r\nI need a ride to the gig.\r\nFor over 20 years, our commitment to customer service has made us the most professional transportation company on the North Shore of Boston. We have secured a reputation of outstanding dedication and service with our thousands of satisfied customers. Which of our services are you interested in?\r\nI need a ride to the gig.\r\nWe would be happy to help you. What is the date of your event?\r\nFebruary 10.2023\r\nThank you. May I have your name?\r\nGeddy\r\nThanks Geddy. How can we get in touch?\r\nEmail Me\r\nMay I have your email address?\r\n<a href='mailto:bass_player' target='blank'>bass_player@yahoo.com</a>\r\nMay we also have your phone number, to better follow up with you?\r\nSure\r\nPlease provide your phone number below.\r\n262-555-0147\r\nThank you. Is there anything else we should know?\r\nNo. Thank you \r\nThank you for contacting us. My staff will follow up with you.Have a great day!\r\n",
                "transcript": [
                    {
                        "id": 1,
                        "timestamp": "1/30/2023 10:50:06 AM",
                        "from": "Virtual Assistant:",
                        "message": "Hello, I’m a Virtual Assistant ready to help. How can I help you?"
                    },
                    {
                        "id": 2,
                        "timestamp": "1/30/2023 10:50:09 AM",
                        "from": "Visitor:",
                        "message": "I need a ride to the gig."
                    },
                    {
                        "id": 3,
                        "timestamp": "1/30/2023 10:50:09 AM",
                        "from": "Virtual Assistant:",
                        "message": "For over 20 years, our commitment to customer service has made us the most professional transportation company on the North Shore of Lake Superior. We have secured a reputation of outstanding dedication and service with our hundreds of satisfied customers. Which of our services are you interested in?"
                    },
                    {
                        "id": 4,
                        "timestamp": "1/30/2023 10:50:31 AM",
                        "from": "Visitor:",
                        "message": "I need a ride to the gig."
                    },
                    {
                        "id": 5,
                        "timestamp": "1/30/2023 10:50:31 AM",
                        "from": "Virtual Assistant:",
                        "message": "We offer limousines, SUVs, and party buses that can fit up to 32 guests. We offer a wide variety of new vehicles that always leave our garage looking impeccable, as a luxury vehicle should. Our chauffeurs are always dressed appropriately, black suit and black tie or for formal events, a full tuxedo to add an air of distinction to your special occasion. Please tell me a bit about what you’re looking for."
                    },
                    {
                        "id": 6,
                        "timestamp": "1/30/2023 10:51:22 AM",
                        "from": "Visitor:",
                        "message": "I need a ride to the gig."
                    },
                    {
                        "id": 7,
                        "timestamp": "1/30/2023 10:51:22 AM",
                        "from": "Virtual Assistant:",
                        "message": "We would be happy to help you. What is the date of your event?"
                    },
                    {
                        "id": 8,
                        "timestamp": "1/30/2023 10:51:40 AM",
                        "from": "Visitor:",
                        "message": "February 10.2023"
                    },
                    {
                        "id": 9,
                        "timestamp": "1/30/2023 10:51:41 AM",
                        "from": "Virtual Assistant:",
                        "message": "Thank you. May I have your name?"
                    },
                    {
                        "id": 10,
                        "timestamp": "1/30/2023 10:51:50 AM",
                        "from": "Visitor:",
                        "message": "Geddy"
                    },
                    {
                        "id": 11,
                        "timestamp": "1/30/2023 10:51:50 AM",
                        "from": "Virtual Assistant:",
                        "message": "Thanks Geddy. How can we get in touch?"
                    },
                    {
                        "id": 12,
                        "timestamp": "1/30/2023 10:52:00 AM",
                        "from": "Visitor:",
                        "message": "Email Me"
                    },
                    {
                        "id": 13,
                        "timestamp": "1/30/2023 10:52:00 AM",
                        "from": "Virtual Assistant:",
                        "message": "May I have your email address?"
                    },
                    {
                        "id": 14,
                        "timestamp": "1/30/2023 10:52:12 AM",
                        "from": "Visitor:",
                        "message": "bass_player@yahoo.com"
                    },
                    {
                        "id": 15,
                        "timestamp": "1/30/2023 10:52:13 AM",
                        "from": "Virtual Assistant:",
                        "message": "May we also have your phone number, to better follow up with you?"
                    },
                    {
                        "id": 16,
                        "timestamp": "1/30/2023 10:52:22 AM",
                        "from": "Visitor:",
                        "message": "Sure"
                    },
                    {
                        "id": 17,
                        "timestamp": "1/30/2023 10:52:22 AM",
                        "from": "Virtual Assistant:",
                        "message": "Please provide your phone number below."
                    },
                    {
                        "id": 18,
                        "timestamp": "1/30/2023 10:52:35 AM",
                        "from": "Visitor:",
                        "message": "262-555-0147"
                    },
                    {
                        "id": 19,
                        "timestamp": "1/30/2023 10:52:36 AM",
                        "from": "Virtual Assistant:",
                        "message": "Thank you. Is there anything else we should know?"
                    },
                    {
                        "id": 20,
                        "timestamp": "1/30/2023 10:53:01 AM",
                        "from": "Visitor:",
                        "message": "No. Thank you"
                    },
                    {
                        "id": 21,
                        "timestamp": "1/30/2023 10:53:01 AM",
                        "from": "Virtual Assistant:",
                        "message": "Thank you for contacting us. My staff will follow up with you.Have a great day!"
                    },
                    {
                        "id": 22,
                        "timestamp": "1/30/2023 10:53:04 AM",
                        "from": "System:",
                        "message": "The chat session has ended."
                    }
                ]
            }
        }
    ]
}
```

The body of the API response will contain metadata and a JSON array of contact interaction objects.

**MetaData**

Field Name | Description
---------- | -----------
global\_master\_advertiser\_id | Global Master Advertiser ID of the contact interactions requested
page | Current page number being displayed
total_pages | Total number of pages of results
next\_page\_location | Complete URL that can be used to retrieve the next page of results.  Will be null if there are no more pages.

**Contact Interaction**

Field | Type  | Description
--------- | -------- |--------
id | Integer | An integer uniquely identifying this contact interaction.
contact_id | Integer | An integer uniquely identifying the contact to which this contact interaction belongs.
campaign_id | Integer | An integer uniquely identifying the campaign that this contact interaction is attributed to.
campaign_name |  String | The name of the campaign that this contact interaction is attributed to.
archived_at | Datetime | The date and time which this contact interaction was archived.<br>**The field is nullable**
created_at | Datetime | The date and time which this contact interaction was created.
important_at | Datetime | The date and time which this contact interaction was marked important.<br>**The field is nullable**
occured_at | Datetime | The date and time which this contact interaction occurred. This will usually be different than the date that the contact interaction was created.
read_at | Datetime | The date and time which this contact interaction was marked read.<br>**The field is nullable**
display_name | String | The display name of the contact interaction.
event_type| String | The type of the contact interaction . Valid values are **chat**, **call** and **form**.
status | String | The status of the associated contact.  Valid values are **pending_contact**, **active_contact interaction**, **client** and **none**.
notes | String | Free form text notes entered by end users onto the contact interaction .<br>**The field is nullable**
tags | Array of String | When present represents a collection of tags use for applying ad-hoc categorization and collation of contact interactions <br>**The field is nullable**.
contact | Contact | The contact to which this contact interaction belongs.  See the contacts page of this document for details

Depending on the type of contact interaction (see the `event_type` attribute), the payload will also include one of the following:

**Chat**

Field | Type | Description
--------- | -------- |-------- |--------
summary | String | A freeform text description of the chat. <br>**The field is nullable**
transcript | Array | An ordered array of [Chat transcript objects](#chattranscript).

<a name="chattranscript"></a>
**ChatTranscript Object**

Field | Type | Description
--------- | -------- |-------- |--------
id | Integer | A sequential id of the line chat transcript.  It uniquely identifies a line of the chat transcript within this contact interaction.
timestamp | String |The date and time that the external chat API registered for this line of the chat transcript.
from | String | The display name of the member of the chat who sent this message.
message | String |The message body of this line of the chat transcript.

<a name="callobject"></a>
**Call**

Field | Type | Description
--------- | -------- |-------- |--------
occured_at | Datetime | The date and time that the call occurred.
duration | Integer | The duration of the call in seconds.
recording_url | String | The URL address to an audio recording of the call.
target_number | String | The call target.

<a name="formfill"></a>
**Form Fill**

Field | Type | Description
--------- | -------- |-------- |--------
sub_type | String | The subtype of the form.  Valid values are **FormPost** and **FormEmail**.
full_message | String | The full form message
subject | String | **The field is nullable** |
extra_fields | JSON Object with custom attributes | **The field is nullable** |
